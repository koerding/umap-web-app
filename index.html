<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UMAP Web App</title>
    <!-- Correct UMAP-JS CDN from unpkg -->
    <script src="https://unpkg.com/umap-js@1.3.3/lib/umap-js.min.js"></script>
    <style>
        canvas {
            border: 1px solid black;
        }
        #container {
            display: flex;
            justify-content: space-around;
        }
    </style>
</head>
<body>
    <h1>UMAP Dimensionality Reduction</h1>

    <label for="nNeighbors">Number of Neighbors (up to 500):</label>
    <input type="range" id="nNeighbors" min="2" max="500" value="15" step="1" oninput="updateSliderValue('nNeighbors', this.value)">
    <span id="nNeighborsValue">15</span>

    <br><br>

    <label for="minDist">Minimum Distance:</label>
    <input type="range" id="minDist" min="0" max="1" value="0.1" step="0.01" oninput="updateSliderValue('minDist', this.value)">
    <span id="minDistValue">0.1</span>

    <br><br>

    <label for="dataset">Choose Dataset:</label>
    <select id="dataset">
        <option value="line">1D Line</option>
        <option value="2d">2D Points</option>
        <option value="dino">Dinosaur</option>
    </select>

    <br><br>

    <button onclick="runUMAP()">Recompute UMAP</button>

    <h2>Raw Data (left) and UMAP Results (right)</h2>

    <div id="container">
        <canvas id="rawDataCanvas" width="400" height="400"></canvas>
        <canvas id="umapCanvas" width="400" height="400"></canvas>
    </div>

    <script>
        const rawCanvas = document.getElementById('rawDataCanvas');
        const rawCtx = rawCanvas.getContext('2d');
        const umapCanvas = document.getElementById('umapCanvas');
        const umapCtx = umapCanvas.getContext('2d');

        function updateSliderValue(sliderId, value) {
            document.getElementById(sliderId + 'Value').textContent = value;
        }

        // Generate 1000 points for each dataset type
        function generateDataset(type) {
            switch (type) {
                case 'line':
                    return Array.from({length: 1000}, (_, i) => [i / 1000, 0.5]);
                case '2d':
                    return Array.from({length: 1000}, () => [Math.random(), Math.random()]);
               case 'dino':
                    return -[
                            [0.251, 0.405],
                            [0.750, 0.683],
                            [0.355, 0.410],
                            [0.639, 0.745],
                            [0.169, 0.754],
                            [0.481, 0.732],
                            [0.716, 0.332],
                            [0.650, 0.752],
                            [0.337, 0.414],
                            [0.595, 0.484],
                            [0.223, 0.769],
                            [0.473, 0.729],
                            [0.271, 0.403],
                            [0.540, 0.487],
                            [0.730, 0.597],
                            [0.757, 0.356],
                            [0.746, 0.335],
                            [0.184, 0.600],
                            [0.573, 0.760],
                            [0.567, 0.416],
                            [0.793, 0.523],
                            [0.639, 0.413],
                            [0.432, 0.588],
                            [0.409, 0.652],
                            [0.212, 0.692],
                            [0.349, 0.521],
                            [0.249, 0.416],
                            [0.306, 0.435],
                            [0.313, 0.588],
                            [0.557, 0.535],
                            [0.635, 0.751],
                            [0.177, 0.726],
                            [0.589, 0.662],
                            [0.286, 0.380],
                            [0.485, 0.446],
                            [0.702, 0.407],
                            [0.569, 0.529],
                            [0.568, 0.407],
                            [0.224, 0.678],
                            [0.746, 0.393],
                            [0.132, 0.734],
                            [0.341, 0.729],
                            [0.448, 0.548],
                            [0.536, 0.646],
                            [0.615, 0.313],
                            [0.754, 0.399],
                            [0.684, 0.332],
                            [0.695, 0.323],
                            [0.195, 0.716],
                            [0.690, 0.326],
                            [0.260, 0.413],
                            [0.451, 0.547],
                            [0.312, 0.627],
                            [0.535, 0.215],
                            [0.352, 0.609],
                            [0.688, 0.332],
                            [0.228, 0.677],
                            [0.216, 0.744],
                            [0.176, 0.804],
                            [0.787, 0.428],
                            [0.482, 0.527],
                            [0.187, 0.759],
                            [0.182, 0.727],
                            [0.357, 0.494],
                            [0.209, 0.717],
                            [0.581, 0.477],
                            [0.506, 0.776],
                            [0.163, 0.806],
                            [0.325, 0.720],
                            [0.177, 0.714],
                            [0.687, 0.374],
                            [0.524, 0.583],
                            [0.542, 0.578],
                            [0.620, 0.343],
                            [0.402, 0.750],
                            [0.826, 0.620],
                            [0.287, 0.555],
                            [0.604, 0.636],
                            [0.432, 0.580],
                            [0.590, 0.294],
                            [0.340, 0.545],
                            [0.314, 0.429],
                            [0.795, 0.654],
                            [0.415, 0.650],
                            [0.624, 0.751],
                            [0.591, 0.402],
                            [0.399, 0.741],
                            [0.208, 0.807],
                            [0.584, 0.628],
                            [0.751, 0.687],
                            [0.786, 0.483],
                            [0.233, 0.728],
                            [0.584, 0.287],
                            [0.461, 0.413],
                            [0.533, 0.268],
                            [0.620, 0.316],
                            [0.732, 0.602],
                            [0.743, 0.585],
                            [0.540, 0.577],
                            [0.403, 0.568],
                            [0.855, 0.453],
                            [0.555, 0.609],
                            [0.484, 0.731],
                            [0.357, 0.416],
                            [0.238, 0.805],
                            [0.562, 0.306],
                            [0.512, 0.406],
                            [0.721, 0.338],
                            [0.420, 0.568],
                            [0.542, 0.613],
                            [0.689, 0.616],
                            [0.637, 0.625],
                            [0.789, 0.479],
                            [0.265, 0.643],
                            [0.528, 0.457],
                            [0.654, 0.326],
                            [0.339, 0.416],
                            [0.311, 0.586],
                            [0.656, 0.621],
                            [0.495, 0.517],
                            [0.479, 0.529],
                            [0.684, 0.410],
                            [0.685, 0.608],
                            [0.441, 0.570],
                            [0.744, 0.337],
                            [0.787, 0.658],
                            [0.826, 0.394],
                            [0.570, 0.429],
                            [0.584, 0.478],
                            [0.782, 0.672],
                            [0.585, 0.409],
                            [0.819, 0.373],
                            [0.404, 0.675],
                            [0.736, 0.340],
                            [0.556, 0.408],
                            [0.510, 0.455],
                            [0.171, 0.726],
                            [0.585, 0.302],
                            [0.621, 0.669],
                            [0.692, 0.404],
                            [0.281, 0.729],
                            [0.336, 0.548],
                            [0.531, 0.213],
                            [0.370, 0.569],
                            [0.566, 0.529],
                            [0.859, 0.535],
                            [0.331, 0.404],
                            [0.398, 0.740],
                            [0.701, 0.723],
                            [0.350, 0.517],
                            [0.795, 0.637],
                            [0.857, 0.482],
                            [0.866, 0.507],
                            [0.501, 0.522],
                            [0.731, 0.604],
                            [0.861, 0.515],
                            [0.604, 0.346],
                            [0.734, 0.591],
                            [0.569, 0.422],
                            [0.382, 0.571],
                            [0.767, 0.549],
                            [0.120, 0.746],
                            [0.175, 0.802],
                            [0.341, 0.446],
                            [0.458, 0.418],
                            [0.449, 0.366],
                            [0.865, 0.483],
                            [0.264, 0.787],
                            [0.841, 0.426],
                            [0.253, 0.616],
                            [0.436, 0.627],
                            [0.780, 0.521],
                            [0.409, 0.630],
                            [0.230, 0.598],
                            [0.782, 0.366],
                            [0.588, 0.502],
                            [0.441, 0.710],
                            [0.266, 0.413],
                            [0.506, 0.597],
                            [0.185, 0.746],
                            [0.355, 0.460],
                            [0.610, 0.407],
                            [0.852, 0.413],
                            [0.115, 0.767],
                            [0.754, 0.338],
                            [0.260, 0.764],
                            [0.492, 0.447],
                            [0.587, 0.478],
                            [0.514, 0.435],
                            [0.519, 0.581],
                            [0.454, 0.556],
                            [0.403, 0.640],
                            [0.793, 0.453],
                            [0.229, 0.414],
                            [0.624, 0.637],
                            [0.646, 0.324],
                            [0.541, 0.288],
                            [0.343, 0.531],
                            [0.422, 0.760],
                            [0.598, 0.763],
                            [0.561, 0.621],
                            [0.539, 0.270],
                            [0.616, 0.344],
                            [0.290, 0.720],
                            [0.530, 0.232],
                            [0.272, 0.407],
                            [0.766, 0.551],
                            [0.269, 0.662],
                            [0.666, 0.322],
                            [0.149, 0.729],
                            [0.594, 0.758],
                            [0.630, 0.411],
                            [0.337, 0.612],
                            [0.607, 0.628],
                            [0.752, 0.585],
                            [0.236, 0.597],
                            [0.344, 0.563],
                            [0.851, 0.441],
                            [0.578, 0.425],
                            [0.211, 0.817],
                            [0.233, 0.602],
                            [0.267, 0.772],
                            [0.224, 0.579],
                            [0.615, 0.300],
                            [0.814, 0.639],
                            [0.751, 0.583],
                            [0.259, 0.780],
                            [0.532, 0.581],
                            [0.657, 0.314],
                            [0.377, 0.407],
                            [0.163, 0.804],
                            [0.776, 0.427],
                            [0.577, 0.403],
                            [0.857, 0.440],
                            [0.243, 0.403],
                            [0.642, 0.625],
                            [0.687, 0.657],
                            [0.792, 0.488],
                            [0.505, 0.597],
                            [0.495, 0.771],
                            [0.647, 0.736],
                            [0.309, 0.440],
                            [0.250, 0.413],
                            [0.754, 0.577],
                            [0.351, 0.524],
                            [0.751, 0.688],
                            [0.340, 0.574],
                            [0.560, 0.617],
                            [0.575, 0.442],
                            [0.232, 0.417],
                            [0.329, 0.442],
                            [0.245, 0.639],
                            [0.425, 0.697],
                            [0.520, 0.619],
                            [0.409, 0.529],
                            [0.713, 0.604],
                            [0.536, 0.195],
                            [0.826, 0.594],
                            [0.636, 0.346],
                            [0.797, 0.658],
                            [0.871, 0.481],
                            [0.249, 0.686],
                            [0.340, 0.577],
                            [0.648, 0.618],
                            [0.131, 0.719],
                            [0.538, 0.680],
                            [0.397, 0.544],
                            [0.359, 0.609],
                            [0.213, 0.813],
                            [0.778, 0.432],
                            [0.176, 0.721],
                            [0.412, 0.745],
                            [0.649, 0.357],
                            [0.586, 0.627],
                            [0.544, 0.607],
                            [0.408, 0.571],
                            [0.721, 0.597],
                            [0.275, 0.753],
                            [0.506, 0.607],
                            [0.299, 0.418],
                            [0.855, 0.521],
                            [0.536, 0.267],
                            [0.458, 0.422],
                            [0.292, 0.574],
                            [0.466, 0.764],
                            [0.846, 0.425],
                            [0.717, 0.388],
                            [0.548, 0.562],
                            [0.566, 0.408],
                            [0.311, 0.431],
                            [0.734, 0.704],
                            [0.251, 0.406],
                            [0.319, 0.588],
                            [0.149, 0.794],
                            [0.201, 0.599],
                            [0.306, 0.405],
                            [0.569, 0.438],
                            [0.362, 0.516],
                            [0.203, 0.705],
                            [0.220, 0.665],
                            [0.861, 0.508],
                            [0.229, 0.569],
                            [0.730, 0.388],
                            [0.219, 0.555],
                            [0.546, 0.679],
                            [0.411, 0.497],
                            [0.670, 0.728],
                            [0.511, 0.437],
                            [0.530, 0.572],
                            [0.331, 0.439],
                            [0.441, 0.648],
                            [0.214, 0.604],
                            [0.837, 0.605],
                            [0.806, 0.368],
                            [0.791, 0.370],
                            [0.274, 0.560],
                            [0.602, 0.349],
                            [0.452, 0.549],
                            [0.443, 0.764],
                            [0.589, 0.411],
                            [0.569, 0.762],
                            [0.266, 0.403],
                            [0.564, 0.274],
                            [0.814, 0.379],
                            [0.194, 0.809],
                            [0.385, 0.412],
                            [0.501, 0.762],
                            [0.550, 0.773],
                            [0.265, 0.642],
                            [0.358, 0.488],
                            [0.412, 0.690],
                            [0.523, 0.496],
                            [0.217, 0.523],
                            [0.292, 0.411],
                            [0.157, 0.799],
                            [0.510, 0.509],
                            [0.681, 0.320],
                            [0.599, 0.337],
                            [0.642, 0.325],
                            [0.315, 0.604],
                            [0.543, 0.605],
                            [0.747, 0.582],
                            [0.406, 0.511],
                            [0.517, 0.604],
                            [0.757, 0.677],
                            [0.589, 0.409],
                            [0.764, 0.688],
                            [0.156, 0.801],
                            [0.605, 0.626],
                            [0.425, 0.403],
                            [0.205, 0.414],
                            [0.305, 0.422],
                            [0.641, 0.663],
                            [0.725, 0.333],
                            [0.518, 0.601],
                            [0.537, 0.583],
                            [0.281, 0.421],
                            [0.545, 0.278],
                            [0.347, 0.469],
                            [0.590, 0.301],
                            [0.564, 0.527],
                            [0.346, 0.543],
                            [0.436, 0.578],
                            [0.793, 0.375],
                            [0.315, 0.723],
                            [0.264, 0.417],
                            [0.775, 0.530],
                            [0.645, 0.746],
                            [0.532, 0.421],
                            [0.548, 0.615],
                            [0.748, 0.686],
                            [0.291, 0.674],
                            [0.559, 0.529],
                            [0.516, 0.506],
                            [0.585, 0.338],
                            [0.152, 0.716],
                            [0.724, 0.699],
                            [0.223, 0.658],
                            [0.238, 0.583],
                            [0.428, 0.695],
                            [0.405, 0.746],
                            [0.566, 0.287],
                            [0.816, 0.373],
                            [0.610, 0.748],
                            [0.340, 0.565],
                            [0.581, 0.631],
                            [0.664, 0.360],
                            [0.532, 0.643],
                            [0.355, 0.473],
                            [0.327, 0.412],
                            [0.503, 0.431],
                            [0.441, 0.646],
                            [0.361, 0.570],
                            [0.418, 0.751],
                            [0.409, 0.606],
                            [0.581, 0.667],
                            [0.314, 0.586],
                            [0.756, 0.577],
                            [0.265, 0.751],
                            [0.844, 0.437],
                            [0.792, 0.537],
                            [0.556, 0.403],
                            [0.858, 0.439],
                            [0.476, 0.404],
                            [0.372, 0.744],
                            [0.309, 0.604],
                            [0.824, 0.610],
                            [0.205, 0.728],
                            [0.575, 0.767],
                            [0.821, 0.394],
                            [0.864, 0.513],
                            [0.223, 0.562],
                            [0.337, 0.457],
                            [0.308, 0.639],
                            [0.565, 0.324],
                            [0.235, 0.556],
                            [0.797, 0.367],
                            [0.260, 0.771],
                            [0.269, 0.599],
                            [0.723, 0.592],
                            [0.726, 0.602],
                            [0.208, 0.726],
                            [0.476, 0.528],
                            [0.736, 0.709],
                            [0.195, 0.806],
                            [0.317, 0.581],
                            [0.113, 0.746],
                            [0.655, 0.365],
                            [0.598, 0.752],
                            [0.364, 0.729],
                            [0.847, 0.545],
                            [0.854, 0.523],
                            [0.292, 0.363],
                            [0.221, 0.597],
                            [0.533, 0.481],
                            [0.862, 0.549],
                            [0.731, 0.706],
                            [0.398, 0.755],
                            [0.250, 0.792],
                            [0.314, 0.448],
                            [0.259, 0.562],
                            [0.734, 0.590],
                            [0.441, 0.407],
                            [0.157, 0.711],
                            [0.644, 0.741],
                            [0.815, 0.373],
                            [0.405, 0.521],
                            [0.188, 0.806],
                            [0.593, 0.621],
                            [0.268, 0.772],
                            [0.188, 0.578],
                            [0.580, 0.442],
                            [0.196, 0.728],
                            [0.566, 0.763],
                            [0.551, 0.606],
                            [0.581, 0.498],
                            [0.696, 0.416],
                            [0.769, 0.343],
                            [0.237, 0.562],
                            [0.448, 0.416],
                            [0.243, 0.582],
                            [0.388, 0.405],
                            [0.803, 0.376],
                            [0.493, 0.770],
                            [0.241, 0.810],
                            [0.524, 0.515],
                            [0.412, 0.648],
                            [0.607, 0.334],
                            [0.543, 0.613],
                            [0.450, 0.359],
                            [0.327, 0.406],
                            [0.747, 0.589],
                            [0.858, 0.533],
                            [0.348, 0.414],
                            [0.410, 0.637],
                            [0.865, 0.456],
                            [0.332, 0.722],
                            [0.329, 0.353],
                            [0.520, 0.230],
                            [0.567, 0.526],
                            [0.758, 0.567],
                            [0.562, 0.766],
                            [0.637, 0.413],
                            [0.660, 0.413],
                            [0.246, 0.627],
                            [0.819, 0.613],
                            [0.583, 0.521],
                            [0.433, 0.713],
                            [0.327, 0.449],
                            [0.687, 0.621],
                            [0.298, 0.435],
                            [0.709, 0.384],
                            [0.364, 0.618],
                            [0.642, 0.636],
                            [0.188, 0.775],
                            [0.577, 0.476],
                            [0.312, 0.727],
                            [0.251, 0.792],
                            [0.239, 0.693],
                            [0.377, 0.575],
                            [0.584, 0.293],
                            [0.253, 0.635],
                            [0.564, 0.764],
                            [0.321, 0.590],
                            [0.365, 0.497],
                            [0.405, 0.646],
                            [0.360, 0.489],
                            [0.405, 0.642],
                            [0.742, 0.336],
                            [0.538, 0.569],
                            [0.387, 0.548],
                            [0.518, 0.620],
                            [0.701, 0.330],
                            [0.530, 0.694],
                            [0.822, 0.382],
                            [0.286, 0.437],
                            [0.546, 0.304],
                            [0.443, 0.604],
                            [0.640, 0.630],
                            [0.269, 0.771],
                            [0.750, 0.574],
                            [0.597, 0.759],
                            [0.859, 0.434],
                            [0.360, 0.512],
                            [0.851, 0.530],
                            [0.192, 0.727],
                            [0.265, 0.768],
                            [0.472, 0.428],
                            [0.461, 0.538],
                            [0.701, 0.416],
                            [0.788, 0.460],
                            [0.327, 0.438],
                            [0.768, 0.675],
                            [0.809, 0.367],
                            [0.307, 0.581],
                            [0.207, 0.552],
                            [0.403, 0.616],
                            [0.553, 0.564],
                            [0.723, 0.601],
                            [0.411, 0.468],
                            [0.544, 0.567],
                            [0.787, 0.356],
                            [0.351, 0.571],
                            [0.322, 0.413],
                            [0.865, 0.479],
                            [0.294, 0.436],
                            [0.861, 0.522],
                            [0.301, 0.417],
                            [0.744, 0.587],
                            [0.821, 0.629],
                            [0.558, 0.611],
                            [0.639, 0.626],
                            [0.614, 0.415],
                            [0.384, 0.604],
                            [0.853, 0.445],
                            [0.361, 0.571],
                            [0.405, 0.473],
                            [0.391, 0.408],
                            [0.788, 0.481],
                            [0.500, 0.411],
                            [0.196, 0.415],
                            [0.355, 0.529],
                            [0.686, 0.728],
                            [0.811, 0.626],
                            [0.545, 0.276],
                            [0.332, 0.416],
                            [0.589, 0.514],
                            [0.622, 0.673],
                            [0.507, 0.437],
                            [0.311, 0.635],
                            [0.272, 0.747],
                            [0.297, 0.582],
                            [0.410, 0.649],
                            [0.295, 0.403],
                            [0.358, 0.466],
                            [0.351, 0.475],
                            [0.545, 0.554],
                            [0.354, 0.578],
                            [0.533, 0.258],
                            [0.164, 0.807],
                            [0.194, 0.805],
                            [0.527, 0.768],
                            [0.336, 0.580],
                            [0.543, 0.291],
                            [0.182, 0.716],
                            [0.818, 0.396],
                            [0.406, 0.519],
                            [0.238, 0.802],
                            [0.654, 0.312],
                            [0.567, 0.430],
                            [0.404, 0.490],
                            [0.376, 0.739],
                            [0.179, 0.803],
                            [0.645, 0.349],
                            [0.790, 0.368],
                            [0.538, 0.238],
                            [0.264, 0.621],
                            [0.217, 0.662],
                            [0.224, 0.554],
                            [0.229, 0.643],
                            [0.493, 0.428],
                            [0.408, 0.671],
                            [0.179, 0.785],
                            [0.736, 0.692],
                            [0.822, 0.396],
                            [0.332, 0.449],
                            [0.683, 0.626],
                            [0.212, 0.706],
                            [0.190, 0.728],
                            [0.435, 0.356],
                            [0.530, 0.646],
                            [0.789, 0.368],
                            [0.590, 0.334],
                            [0.488, 0.408],
                            [0.521, 0.637],
                            [0.328, 0.419],
                            [0.630, 0.671],
                            [0.330, 0.449],
                            [0.555, 0.766],
                            [0.502, 0.510],
                            [0.854, 0.558],
                            [0.419, 0.749],
                            [0.826, 0.593],
                            [0.364, 0.576],
                            [0.794, 0.498],
                            [0.514, 0.773],
                            [0.803, 0.380],
                            [0.545, 0.251],
                            [0.407, 0.661],
                            [0.539, 0.282],
                            [0.458, 0.720],
                            [0.110, 0.729],
                            [0.470, 0.539],
                            [0.639, 0.319],
                            [0.391, 0.409],
                            [0.695, 0.725],
                            [0.159, 0.728],
                            [0.405, 0.500],
                            [0.850, 0.451],
                            [0.866, 0.502],
                            [0.146, 0.787],
                            [0.682, 0.733],
                            [0.723, 0.387],
                            [0.371, 0.732],
                            [0.557, 0.414],
                            [0.512, 0.775],
                            [0.311, 0.626],
                            [0.270, 0.411],
                            [0.854, 0.439],
                            [0.563, 0.281],
                            [0.348, 0.730],
                            [0.155, 0.793],
                            [0.275, 0.666],
                            [0.250, 0.618],
                            [0.783, 0.460],
                            [0.186, 0.786],
                            [0.450, 0.770],
                            [0.705, 0.712],
                            [0.253, 0.783],
                            [0.556, 0.312],
                            [0.781, 0.666],
                            [0.193, 0.722],
                            [0.319, 0.585],
                            [0.286, 0.408],
                            [0.465, 0.772],
                            [0.534, 0.485],
                            [0.796, 0.358],
                            [0.578, 0.764],
                            [0.394, 0.418],
                            [0.729, 0.694],
                            [0.258, 0.606],
                            [0.709, 0.723],
                            [0.280, 0.428],
                            [0.446, 0.416],
                            [0.569, 0.773],
                            [0.281, 0.556],
                            [0.222, 0.531],
                            [0.528, 0.409],
                            [0.463, 0.533],
                            [0.860, 0.462],
                            [0.382, 0.416],
                            [0.855, 0.528],
                            [0.156, 0.742],
                            [0.790, 0.362],
                            [0.386, 0.439],
                            [0.589, 0.669],
                            [0.462, 0.423],
                            [0.859, 0.496],
                            [0.219, 0.774],
                            [0.165, 0.741],
                            [0.300, 0.591],
                            [0.551, 0.555],
                            [0.570, 0.414],
                            [0.326, 0.583],
                            [0.270, 0.602],
                            [0.763, 0.570],
                            [0.473, 0.404],
                            [0.454, 0.734],
                            [0.570, 0.444],
                            [0.691, 0.326],
                            [0.591, 0.490],
                            [0.268, 0.618],
                            [0.562, 0.283],
                            [0.688, 0.324],
                            [0.352, 0.516],
                            [0.746, 0.698],
                            [0.806, 0.382],
                            [0.197, 0.727],
                            [0.537, 0.586],
                            [0.521, 0.245],
                            [0.730, 0.698],
                            [0.723, 0.598],
                            [0.113, 0.773],
                            [0.181, 0.760],
                            [0.380, 0.613],
                            [0.330, 0.439],
                            [0.337, 0.731],
                            [0.350, 0.541],
                            [0.525, 0.214],
                            [0.183, 0.585],
                            [0.825, 0.382],
                            [0.758, 0.345],
                            [0.516, 0.453],
                            [0.632, 0.750],
                            [0.676, 0.317],
                            [0.531, 0.272],
                            [0.288, 0.724],
                            [0.548, 0.294],
                            [0.749, 0.398],
                            [0.354, 0.614],
                            [0.481, 0.773],
                            [0.846, 0.424],
                            [0.541, 0.702],
                            [0.521, 0.634],
                            [0.543, 0.660],
                            [0.686, 0.737],
                            [0.497, 0.519],
                            [0.570, 0.406],
                            [0.482, 0.411],
                            [0.793, 0.645],
                            [0.279, 0.739],
                            [0.204, 0.407],
                            [0.430, 0.576],
                            [0.653, 0.632],
                            [0.438, 0.760],
                            [0.611, 0.348],
                            [0.662, 0.369],
                            [0.354, 0.725],
                            [0.770, 0.354],
                            [0.688, 0.376],
                            [0.456, 0.730],
                            [0.416, 0.637],
                            [0.110, 0.734],
                            [0.318, 0.436],
                            [0.788, 0.483],
                            [0.166, 0.729],
                            [0.515, 0.410],
                            [0.522, 0.444],
                            [0.161, 0.717],
                            [0.282, 0.424],
                            [0.618, 0.350],
                            [0.579, 0.461],
                            [0.209, 0.808],
                            [0.794, 0.521],
                            [0.568, 0.757],
                            [0.642, 0.745],
                            [0.532, 0.680],
                            [0.655, 0.318],
                            [0.756, 0.686],
                            [0.509, 0.770],
                            [0.822, 0.610],
                            [0.697, 0.321],
                            [0.760, 0.345],
                            [0.839, 0.404],
                            [0.538, 0.775],
                            [0.251, 0.647],
                            [0.309, 0.617],
                            [0.865, 0.451],
                            [0.773, 0.412],
                            [0.353, 0.407],
                            [0.511, 0.617],
                            [0.722, 0.641],
                            [0.472, 0.406],
                            [0.257, 0.564],
                            [0.630, 0.321],
                            [0.255, 0.594],
                            [0.404, 0.749],
                            [0.592, 0.411],
                            [0.758, 0.581],
                            [0.255, 0.786],
                            [0.854, 0.553],
                            [0.206, 0.608],
                            [0.334, 0.420],
                            [0.709, 0.601],
                            [0.790, 0.475],
                            [0.658, 0.748],
                            [0.867, 0.504],
                            [0.396, 0.411],
                            [0.795, 0.532],
                            [0.546, 0.403],
                            [0.267, 0.604],
                            [0.749, 0.351],
                            [0.736, 0.339],
                            [0.545, 0.771],
                            [0.835, 0.404],
                            [0.863, 0.468],
                            [0.701, 0.647],
                            [0.771, 0.346],
                            [0.315, 0.428],
                            [0.765, 0.557],
                            [0.611, 0.413],
                            [0.445, 0.717],
                            [0.561, 0.281],
                            [0.788, 0.504],
                            [0.813, 0.614],
                            [0.357, 0.507],
                            [0.685, 0.329],
                            [0.809, 0.384],
                            [0.588, 0.411],
                            [0.413, 0.545],
                            [0.540, 0.703],
                            [0.400, 0.457],
                            [0.699, 0.719],
                            [0.644, 0.663],
                            [0.413, 0.665],
                            [0.260, 0.647],
                            [0.624, 0.308],
                            [0.438, 0.361],
                            [0.800, 0.373],
                            [0.507, 0.594],
                            [0.759, 0.418],
                            [0.227, 0.646],
                            [0.793, 0.536],
                            [0.654, 0.404],
                            [0.591, 0.307],
                            [0.286, 0.364],
                            [0.509, 0.431],
                            [0.475, 0.445],
                            [0.863, 0.514],
                            [0.161, 0.726],
                            [0.159, 0.796],
                            [0.414, 0.500],
                            [0.571, 0.404],
                            [0.548, 0.405],
                            [0.611, 0.765],
                            [0.660, 0.745],
                            [0.621, 0.407],
                            [0.125, 0.777],
                            [0.539, 0.289],
                            [0.843, 0.414],
                            [0.647, 0.358],
                            [0.354, 0.577],
                            [0.804, 0.490],
                            [0.546, 0.552],
                            [0.247, 0.689],
                            [0.508, 0.454],
                            [0.375, 0.747],
                            [0.281, 0.562],
                            [0.748, 0.343],
                            [0.562, 0.544],
                            [0.730, 0.387],
                            [0.434, 0.703],
                            [0.538, 0.565],
                            [0.354, 0.479],
                            [0.528, 0.646],
                            [0.419, 0.681],
                            [0.280, 0.563],
                            [0.551, 0.564],
                            [0.304, 0.447],
                            [0.277, 0.372],
                            [0.378, 0.743],
                            [0.648, 0.742],
                            [0.285, 0.428],
                            [0.720, 0.604],
                            [0.635, 0.412],
                            [0.330, 0.584],
                            [0.765, 0.354],
                            [0.869, 0.523],
                            [0.515, 0.421],
                            [0.285, 0.426],
                            [0.779, 0.360],
                            [0.401, 0.653],
                            [0.303, 0.604],
                            [0.581, 0.316],
                            [0.541, 0.287],
                            [0.409, 0.520],
                            [0.787, 0.532],
                            [0.308, 0.573],
                            [0.206, 0.607],
                            [0.824, 0.403],
                            [0.263, 0.777],
                            [0.335, 0.403],
                            [0.768, 0.545],
                            [0.210, 0.543],
                            [0.719, 0.374],
                            [0.285, 0.555],
                            [0.387, 0.448],
                            [0.191, 0.411],
                            [0.537, 0.496],
                            [0.288, 0.425],
                            [0.239, 0.574],
                            [0.866, 0.482],
                            [0.739, 0.699],
                            [0.739, 0.700],
                            [0.359, 0.567],
                            [0.692, 0.727],
                            [0.416, 0.512],
                            [0.197, 0.716],
                            [0.201, 0.408],
                            [0.524, 0.249],
                            [0.770, 0.554],
                            [0.537, 0.696],
                            [0.482, 0.739],
                            [0.351, 0.534],
                            [0.793, 0.476],
                            [0.639, 0.414],
                            [0.726, 0.392],
                            [0.301, 0.440],
                            [0.438, 0.727],
                            [0.209, 0.548],
                            [0.705, 0.601],
                            [0.353, 0.613],
                            [0.559, 0.305],
                            [0.735, 0.698],
                            [0.717, 0.605],
                            [0.548, 0.616],
                            [0.239, 0.604],
                            [0.227, 0.554],
                            [0.534, 0.698],
                            [0.511, 0.771],
                            [0.640, 0.741],
                            [0.514, 0.588],
                            [0.544, 0.287],
                            [0.742, 0.581],
                            [0.211, 0.725],
                            [0.255, 0.659],
                            [0.586, 0.457],
                            [0.646, 0.753],
                            [0.562, 0.614],
                            [0.619, 0.354],
                            [0.575, 0.466],
                            [0.442, 0.760],
                            [0.466, 0.418],
                            [0.525, 0.460],
                            [0.513, 0.592],
                            [0.547, 0.615],
                            [0.756, 0.339],
                            [0.438, 0.629],
                            [0.234, 0.731],
                            [0.384, 0.438],
                            [0.865, 0.441],
                            [0.551, 0.561],
                            [0.475, 0.413],
                            [0.622, 0.746],
                            [0.674, 0.324],
                            [0.229, 0.583],
                            [0.387, 0.561],
                            [0.158, 0.723],
                            [0.857, 0.489],
                            [0.603, 0.304],
                            [0.649, 0.317],
                            [0.781, 0.674],
                            [0.296, 0.562],
                            [0.237, 0.718],
                            [0.332, 0.588],
                            [0.438, 0.569],
                            [0.388, 0.740],
                            [0.494, 0.514],
                            [0.293, 0.578],
                            [0.858, 0.433],
                            [0.712, 0.327],
                            [0.535, 0.421],
                            [0.709, 0.645],
                            [0.375, 0.425],
                            [0.358, 0.414],
                            [0.353, 0.608],
                            [0.723, 0.393],
                            [0.400, 0.500],
                            [0.321, 0.593],
                            [0.310, 0.617],
                            [0.414, 0.674],
                            [0.780, 0.554],
                            [0.598, 0.342],
                            [0.743, 0.693],
                            [0.363, 0.412],
                            [0.613, 0.347],
                            [0.521, 0.206],
                            [0.640, 0.622],
                            [0.353, 0.416],
                            [0.803, 0.377],
                            [0.242, 0.702],
                            [0.188, 0.725],
                            [0.848, 0.429],
                            [0.764, 0.348],
                            [0.698, 0.408],
                            [0.527, 0.650],
                            [0.518, 0.614],
                            [0.620, 0.627],
                            [0.415, 0.473],
                            [0.317, 0.619]
                            ];         
                default:
                    return [];
            }
        }

        // Normalize and scale points to fit the canvas
        function normalize(embedding, canvasSize) {
            const minX = Math.min(...embedding.map(p => p[0]));
            const maxX = Math.max(...embedding.map(p => p[0]));
            const minY = Math.min(...embedding.map(p => p[1]));
            const maxY = Math.max(...embedding.map(p => p[1]));

            const scaleX = maxX - minX === 0 ? 1 : maxX - minX;
            const scaleY = maxY - minY === 0 ? 1 : maxY - minY;

            return embedding.map(([x, y]) => [
                ((x - minX) / scaleX) * canvasSize,
                ((y - minY) / scaleY) * canvasSize
            ]);
        }

        function plotPoints(ctx, points, canvas) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            points.forEach(point => {
                ctx.beginPath();
                ctx.arc(point[0], point[1], 2, 0, Math.PI * 2);
                ctx.fill();
            });
        }

        async function runUMAP() {
            const nNeighbors = parseInt(document.getElementById('nNeighbors').value);
            const minDist = parseFloat(document.getElementById('minDist').value);
            const datasetType = document.getElementById('dataset').value;

            const data = generateDataset(datasetType);

            // Plot raw data
            const normalizedRawData = normalize(data, rawCanvas.width);
            plotPoints(rawCtx, normalizedRawData, rawCanvas);

            // Run UMAP
            const umap = new UMAP({
                nNeighbors: nNeighbors,
                minDist: minDist
            });

            const embedding = await umap.fitAsync(data);

            // Plot UMAP result
            const normalizedEmbedding = normalize(embedding, umapCanvas.width);
            plotPoints(umapCtx, normalizedEmbedding, umapCanvas);
        }

        window.onload = function() {
            runUMAP(); // Initial run
        }
    </script>
</body>
</html>

